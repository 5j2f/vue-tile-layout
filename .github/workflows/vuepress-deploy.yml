name: Vuepress Build and Deploy

on:
  push:
    branches: [ main ]
    paths:
      - 'docs/**'
      - '.github/**'

jobs:
  build-and-deploy:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [16.x]

    steps:
    
    - name: test
      run: |
        echo "$ACCESS_TOKEN"
        echo "${ACCESS_TOKEN}"
        echo "https://$ACCESS_TOKEN@github"
    
    - name: Checkout
      uses: actions/checkout@main
       
    - name: install
      run: npm ci
      working-directory: ./docs
      
    - name: build
      run: npm run build
      working-directory: ./docs
      
    - name: deploy
      run: |
        git init 
        git config user.name "$GITHUB_ACTOR"
        git config user.email "$GITHUB_ACTOR@users.noreply.github.com"
        git add -A  
        git commit -m "deploy"
        git push -f https://$secrets.ACCESS_TOKEN@github.com:MikesGlitch/vue-griddy.git master:gh-pages
      working-directory: ./docs/src/.vuepress/dist   
   
  #  - name: GitHub Push
  #    uses: ad-m/github-push-action@v0.6.0
  #    with:
  #      github_token: ${{ secrets.GITHUB_TOKEN }}
  #      branch: gh-pages
  #      force: true
  #      directory: ./docs/src/.vuepress/dist   
   
